
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dubae Clothing - Urban Fashion</title>
    <meta name="description" content="Modern and elegant urban clothing store in Santo Domingo.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Montserrat', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    colors: {
                        dubae: {
                            black: '#1a1a1a',
                            gold: '#d4af37',
                            beige: '#f5f5f0',
                            gray: '#8c8c8c'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
        }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #d4af37; border-radius: 4px; }

        /* Mobile Touch Optimizations */
        button {
            touch-action: manipulation;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
        }

        .size-btn {
            min-width: 2.2rem;
            height: 2.2rem;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            border: 1px solid #e5e7eb;
            color: #4b5563;
        }
        .size-btn.selected {
            background-color: #1a1a1a;
            color: white;
            border-color: #1a1a1a;
            font-weight: 700;
            transform: scale(1.05);
        }

        #cart-sidebar {
            transition: transform 0.3s ease-in-out;
            transform: translateX(100%);
        }
        #cart-sidebar.open { transform: translateX(0); }
        #cart-overlay { transition: opacity 0.3s ease-in-out; pointer-events: none; opacity: 0; }
        #cart-overlay.open { pointer-events: auto; opacity: 1; }

        .category-card {
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }
        .category-card:active { transform: scale(0.95); }
        .category-card img { transition: transform 0.6s ease; }
        .category-card:hover img { transform: scale(1.1); }

        /* =========================================
           ZOOM VISUAL PRODUCTOS (UPDATED)
           ========================================= */
        .product-img-container {
            height: 240px; 
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #ffffff;
            padding: 0; /* Reduced padding for larger look */
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .product-img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Cover as requested */
            
            transition: transform 1.2s cubic-bezier(0.2, 1, 0.2, 1), filter 0.5s ease;
            pointer-events: none;
            will-change: transform;
            
            /* Start normal scale since we are using cover */
            transform: scale(1.0); 
        }

        /* Hover Effect Desktop */
        .group:hover .product-img {
            transform: scale(1.1);
            filter: brightness(1.05);
        }

        /* Hover Effect Mobile */
        @media (max-width: 768px) {
            .product-img {
                transform: scale(1.0); 
            }
            .group:hover .product-img {
                transform: scale(1.1);
            }
        }

        .badge-label {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 10;
            font-size: 9px;
            font-weight: 800;
            letter-spacing: 0.05em;
            padding: 3px 8px;
            border-radius: 4px;
            text-transform: uppercase;
        }

        /* Updated Language Button Styles for Mobile */
        .lang-btn {
            font-size: 0.85rem;
            font-weight: 700;
            padding: 8px 12px; /* Increased padding for touch target */
            min-width: 44px; /* Minimum touch target width */
            border-radius: 6px;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
        }
        .lang-btn.active {
            background-color: #1a1a1a;
            color: white;
        }
        .lang-btn:not(.active) {
            color: #8c8c8c;
        }
        .lang-btn:not(.active):active { /* Using active instead of hover for mobile feedback */
            color: #1a1a1a;
            background-color: rgba(0,0,0,0.05);
        }
        @media (hover: hover) {
            .lang-btn:not(.active):hover {
                color: #1a1a1a;
            }
        }

        /* Cart Close Button Mobile Fix */
        #cart-close-btn {
            width: 44px; /* Minimum touch target */
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 1.25rem;
            color: #4b5563;
            transition: background-color 0.2s;
            z-index: 100;
            border: none;
            background: transparent;
            cursor: pointer;
        }
        #cart-close-btn:active {
            background-color: #e5e7eb;
        }
        @media (hover: hover) {
            #cart-close-btn:hover {
                background-color: #f3f4f6;
            }
        }

        .hero-title-shadow {
            text-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }

        /* Detail View Styles */
        #detail-view {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-input {
            transition: all 0.2s;
        }
        .form-input:focus {
            border-color: #1a1a1a;
            box-shadow: 0 0 0 1px #1a1a1a;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body class="bg-neutral-50 text-dubae-black font-sans overflow-x-hidden">

    <!-- Navigation -->
    <nav class="fixed w-full z-50 bg-white/90 backdrop-blur-md border-b border-gray-100 h-20" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex justify-between items-center h-full">
                <a href="#" class="flex items-center gap-3" onclick="resetView(); return false;">
                    <img src="https://i.postimg.cc/YqCkZcVk/Logo.jpg" alt="Dubae Logo" class="h-10 w-10 rounded-full object-cover border border-gray-100">
                    <span class="font-serif font-bold text-xl tracking-tight hidden sm:block">Dubae Clothing</span>
                </a>

                <div class="flex items-center gap-4">
                    <div class="flex items-center bg-gray-100 p-1 rounded-lg border border-gray-200">
                        <!-- Updated Language Switcher with type="button" and improved classes -->
                        <button onclick="setLanguage('en')" id="lang-en" type="button" class="lang-btn active">EN</button>
                        <div class="w-[1px] h-4 bg-gray-300 mx-1"></div>
                        <button onclick="setLanguage('es')" id="lang-es" type="button" class="lang-btn">ES</button>
                    </div>

                    <button onclick="toggleCart()" class="relative p-2 hover:bg-gray-100 rounded-full group transition-colors" style="min-width: 44px; min-height: 44px; display: flex; align-items: center; justify-content: center;">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <span id="cart-count" class="hidden absolute top-0 right-0 bg-dubae-gold text-white text-[10px] font-bold w-4 h-4 rounded-full flex items-center justify-center">0</span>
                    </button>
                    
                    <a href="https://wa.me/18297207993?text=Hello,%20I%20would%20like%20to%20place%20an%20order" target="_blank" id="nav-cta" class="hidden sm:flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-full font-bold text-sm hover:bg-green-700 transition-colors shadow-lg">
                        <svg viewBox="0 0 24 24" class="w-4 h-4 fill-current" xmlns="http://www.w3.org/2000/svg"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.305-5.235c0-5.453 4.435-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
                        Order Now
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Home (Hero Section) -->
    <section id="home" class="relative min-h-screen flex items-center justify-center overflow-hidden bg-[#0f0f0f]">
        <!-- Blurred Background Layer -->
        <div class="absolute inset-0 z-0 scale-110 opacity-30 blur-3xl pointer-events-none">
            <div class="w-full h-full" style="background-image: url('https://i.postimg.cc/s2XH3TvG/dubae-clothing-portada.jpg'); background-size: cover; background-position: center;"></div>
        </div>

        <!-- Main Image -->
        <div class="absolute inset-0 z-0">
            <!-- Changed background-size to cover for immersive full width look -->
            <div class="w-full h-full" style="background-image: url('https://i.postimg.cc/s2XH3TvG/dubae-clothing-portada.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat;"></div>
            <div class="absolute inset-0 bg-black/40"></div>
        </div>

        <!-- Text Content -->
        <div class="relative z-10 text-center px-4 max-w-4xl">
            <h1 id="home-title" class="text-5xl md:text-8xl font-serif font-bold text-white mb-6 hero-title-shadow tracking-tight">Dubae Clothing</h1>
            <p id="home-subtitle" class="text-xl md:text-2xl font-light text-dubae-gold mb-8 uppercase tracking-[0.2em] font-sans">Another concept of fashion.</p>
            <p id="home-copy" class="text-lg md:text-xl text-gray-200 font-light leading-relaxed max-w-2xl mx-auto drop-shadow">Where style becomes identity. Curated pieces that redefine modern fashion, exclusivity, and attitude.</p>
            
            <a href="#catalog" class="mt-12 inline-block border-2 border-white/30 text-white hover:bg-white hover:text-black px-10 py-4 rounded-full transition-all duration-300 backdrop-blur-sm uppercase font-bold text-sm tracking-widest">
                Discover the Collection
            </a>
        </div>
    </section>

    <!-- Catalog Section -->
    <section id="catalog" class="py-16 md:py-24 bg-neutral-50 min-h-screen border-t border-gray-100 relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12 md:mb-16">
                <h2 id="collection-title" class="text-4xl md:text-5xl font-serif font-bold text-gray-900 mb-4">Sneaker Collection</h2>
                <p id="collection-subtitle" class="text-gray-500 max-w-lg mx-auto">Explore our exclusive selection of sneakers.</p>
            </div>

            <!-- App Search Bar -->
            <div class="max-w-2xl mx-auto mb-12 md:mb-16 sticky top-24 z-40">
                <div class="relative group">
                    <input 
                        type="text" 
                        id="search-input"
                        placeholder="Search by model or brand..." 
                        class="w-full px-6 py-4 md:py-5 pl-14 bg-white border border-gray-200 rounded-2xl md:rounded-3xl shadow-xl focus:outline-none focus:ring-2 focus:ring-dubae-gold transition-all text-lg"
                        oninput="handleSearch(this.value)"
                    >
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 absolute left-5 top-1/2 -translate-y-1/2 text-gray-400 group-focus-within:text-dubae-gold transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                    <button id="clear-search" onclick="resetSearch()" class="hidden absolute right-5 top-1/2 -translate-y-1/2 text-gray-400 hover:text-black font-bold">âœ•</button>
                </div>
            </div>

            <!-- Group / Category View -->
            <div id="category-view" class="space-y-12 animate-fade-in">
                <h2 id="cat-title" class="text-2xl font-bold text-gray-800 text-center uppercase tracking-widest">Explore by Brand</h2>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4 lg:gap-6">
                    <div onclick="filterByBrand('Adidas')" class="category-card cursor-pointer group bg-white rounded-xl shadow-sm border border-gray-100 p-4 h-40 md:h-48 flex flex-col items-center justify-center text-center">
                        <img src="https://i.postimg.cc/KjsRSsTM/Adidas-Samba-OG-White-Black-Gum.jpg" alt="Adidas" class="h-20 md:h-24 w-auto object-contain mb-3 md:mb-4 mix-blend-multiply">
                        <span class="font-bold text-sm md:text-lg uppercase tracking-widest group-hover:text-dubae-gold">Adidas</span>
                    </div>
                    <div onclick="filterByBrand('Nike')" class="category-card cursor-pointer group bg-white rounded-xl shadow-sm border border-gray-100 p-4 h-40 md:h-48 flex flex-col items-center justify-center text-center">
                        <img src="https://i.postimg.cc/SRQ4mszw/Nike-V5-RNR-Triple-Black-Mens.jpg" alt="Nike" class="h-20 md:h-24 w-auto object-contain mb-3 md:mb-4 mix-blend-multiply">
                        <span class="font-bold text-sm md:text-lg uppercase tracking-widest group-hover:text-dubae-gold">Nike</span>
                    </div>
                    <div onclick="filterByBrand('ASICS')" class="category-card cursor-pointer group bg-white rounded-xl shadow-sm border border-gray-100 p-4 h-40 md:h-48 flex flex-col items-center justify-center text-center">
                        <img src="https://i.postimg.cc/s2L7YdKk/ASICS-GEL-1130-White-Silver-Black.jpg" alt="ASICS" class="h-20 md:h-24 w-auto object-contain mb-3 md:mb-4 mix-blend-multiply">
                        <span class="font-bold text-sm md:text-lg uppercase tracking-widest group-hover:text-dubae-gold">ASICS</span>
                    </div>
                    <div onclick="filterByBrand('New Balance')" class="category-card cursor-pointer group bg-white rounded-xl shadow-sm border border-gray-100 p-4 h-40 md:h-48 flex flex-col items-center justify-center text-center">
                        <img src="https://i.postimg.cc/sD2T3KkH/New-Balance-530-White-Navy.jpg" alt="New Balance" class="h-20 md:h-24 w-auto object-contain mb-3 md:mb-4 mix-blend-multiply">
                        <span class="font-bold text-sm md:text-lg uppercase tracking-widest group-hover:text-dubae-gold">New Balance</span>
                    </div>
                    <div onclick="filterByBrand('New Arrivals')" class="category-card cursor-pointer group bg-dubae-black rounded-xl shadow-xl p-4 h-40 md:h-48 flex flex-col items-center justify-center text-center">
                        <div class="bg-dubae-gold text-white text-[9px] px-2 py-0.5 rounded-full mb-2 font-bold animate-pulse">HOT</div>
                        <span id="cat-new" class="font-bold text-sm md:text-lg uppercase tracking-widest text-white">New Arrivals</span>
                        <p id="cat-new-desc" class="text-[9px] text-gray-400 mt-1 md:mt-2">The latest collection</p>
                    </div>
                    <div onclick="filterByBrand('Sale')" class="category-card cursor-pointer group bg-red-600 rounded-xl shadow-xl p-4 h-40 md:h-48 flex flex-col items-center justify-center text-center">
                        <span id="cat-sale" class="font-bold text-sm md:text-lg uppercase tracking-widest text-white">Sale</span>
                        <p id="cat-sale-desc" class="text-[9px] text-red-100 mt-1 md:mt-2">Limited offers</p>
                    </div>
                </div>
            </div>

            <!-- Product Grid View -->
            <div id="product-view" class="hidden animate-fade-in space-y-8">
                <div class="flex items-center justify-between border-b border-gray-200 pb-4 md:pb-6 mb-8 md:mb-12">
                    <button onclick="resetView()" class="flex items-center gap-2 text-gray-500 hover:text-black font-bold transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        <span id="view-back" class="text-sm md:text-base">Back</span>
                    </button>
                    <h3 id="view-title" class="text-lg md:text-2xl font-bold text-gray-900 uppercase tracking-widest">All</h3>
                    <div class="w-10"></div>
                </div>

                <!-- Grid Ajustado: 2 col mobile, 4 col desktop -->
                <div id="product-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-4 lg:gap-6">
                    <!-- Products injected via JS -->
                </div>
            </div>

            <!-- Detail View -->
            <div id="detail-view" class="hidden animate-fade-in w-full bg-white z-[60] relative">
                <!-- Content injected via JS -->
            </div>
        </div>
    </section>

    <!-- Location -->
    <section id="location" class="py-24 bg-white">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <h2 id="loc-title" class="text-4xl font-serif font-bold mb-12">Our Store</h2>
            <div class="bg-gray-100 rounded-[2rem] md:rounded-[3rem] h-[400px] md:h-[500px] overflow-hidden shadow-2xl relative border-4 md:border-8 border-white">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3782.3564996452296!2d-69.9392231!3d18.5580053!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8eaf8b0051e85501%3A0x1d0f5e1f0f0f0f0f!2sAv.%20Hermanas%20Mirabal%20461%2C%20Santo%20Domingo%2011201!5e0!3m2!1ses!2sdo!4v1700000000000!5m2!1ses!2sdo" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
            </div>
            <p id="loc-address" class="mt-10 text-lg md:text-xl text-gray-600 italic">Hermanas Mirabal Ave 461, North Santo Domingo</p>
            
            <div class="mt-8">
                <a href="https://maps.app.goo.gl/mKMbWfN3xMKDLvmcA" target="_blank" class="inline-flex items-center gap-3 bg-dubae-black text-white px-8 py-4 rounded-full font-bold text-sm uppercase hover:bg-gray-800 transition-all shadow-lg tracking-widest hover:scale-105 active:scale-95">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-dubae-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    <span id="loc-btn-text">Go to Dubae Clothing</span>
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dubae-black text-white py-16">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <div class="flex flex-col items-center gap-6">
                <img src="https://i.postimg.cc/YqCkZcVk/Logo.jpg" alt="Dubae Logo" class="h-16 w-16 rounded-full border-2 border-dubae-gold/30">
                <p class="mb-4 text-lg">&copy; <span id="year"></span> Dubae Clothing. <span id="footer-copy">All rights reserved.</span></p>
                <div class="flex justify-center gap-8">
                    <a href="https://instagram.com/dubaeclothing" target="_blank" class="text-gray-400 hover:text-dubae-gold transition-colors">Instagram</a>
                    <a href="https://wa.me/18297207993" target="_blank" class="text-gray-400 hover:text-dubae-gold transition-colors">WhatsApp</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Cart Sidebar & Overlay -->
    <!-- Updated onclick to closeCart() for overlay -->
    <div id="cart-overlay" onclick="closeCart()" class="fixed inset-0 bg-black/50 z-[60]"></div>
    <div id="cart-sidebar" class="fixed top-0 right-0 h-full w-full max-w-sm bg-white shadow-2xl z-[70] flex flex-col">
        <div class="p-6 border-b border-gray-100 flex justify-between items-center">
            <h2 id="cart-sidebar-title" class="text-xl font-bold flex items-center gap-2">ðŸ›’ Your Cart</h2>
            <!-- Updated Close Button with ID, explicit click handler and touch optimizations -->
            <button id="cart-close-btn" onclick="closeCart()" type="button" aria-label="Close cart" class="z-[100] relative">âœ•</button>
        </div>
        
        <!-- Cart Scrollable Area including Items and Form -->
        <div class="flex-1 overflow-y-auto">
            <div id="cart-items" class="p-6 space-y-4"></div>
            
            <!-- Customer Form -->
            <div id="cart-customer-form" class="p-6 border-t border-gray-100 hidden bg-gray-50/50">
                <h3 class="text-sm font-bold uppercase tracking-widest mb-4 flex items-center gap-2" id="form-title">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                    Customer Info
                </h3>
                <div class="space-y-3">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1" id="lbl-name">Full Name *</label>
                        <input type="text" id="cust-name" name="name" autocomplete="name" class="form-input w-full p-2.5 border border-gray-200 rounded-lg text-sm outline-none bg-white text-gray-900 placeholder-gray-400" placeholder="John Doe">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1" id="lbl-phone">Phone Number *</label>
                        <input type="tel" id="cust-phone" name="phone" autocomplete="tel" class="form-input w-full p-2.5 border border-gray-200 rounded-lg text-sm outline-none bg-white text-gray-900 placeholder-gray-400" placeholder="+1 809...">
                    </div>
                    <!-- NEW ADDRESS FIELD -->
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1" id="lbl-address">Delivery Address *</label>
                        <textarea id="cust-address" name="address" rows="2" class="form-input w-full p-2.5 border border-gray-200 rounded-lg text-sm outline-none bg-white text-gray-900 placeholder-gray-400 resize-none" placeholder="Street, City..."></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 mb-1" id="lbl-notes">Notes (Optional)</label>
                        <textarea id="cust-notes" rows="2" class="form-input w-full p-2.5 border border-gray-200 rounded-lg text-sm outline-none bg-white text-gray-900 placeholder-gray-400 resize-none" placeholder="Special instructions..."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="p-8 border-t border-gray-100 bg-white">
            <div class="flex justify-between mb-6 text-2xl font-bold">
                <span id="cart-total-label">Total</span>
                <span id="cart-total">$0 USD</span>
            </div>
            <button id="cart-checkout" onclick="checkoutCart()" class="w-full bg-dubae-black text-white py-5 rounded-2xl font-bold uppercase hover:bg-gray-800 transition-all shadow-lg tracking-widest">Order via WhatsApp</button>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed top-24 right-5 bg-black text-white px-6 py-4 rounded-2xl shadow-2xl transform transition-all duration-300 z-[80] translate-y-[-150%] opacity-0 flex items-center gap-3">
        <span id="toast-message" class="font-medium">Message</span>
    </div>

    <script>
        const WHATSAPP_NUMBER = "18297207993";
        let currentLang = localStorage.getItem('dubae_lang') || 'en';
        
        const translations = {
            en: {
                homeTitle: "Dubae Clothing",
                homeSubtitle: "Another concept of fashion.",
                homeCopy: "Where style becomes identity. Curated pieces that redefine modern fashion, exclusivity, and attitude.",
                homeDiscover: "Discover the Collection",
                collectionTitle: "Sneaker Collection",
                collectionSubtitle: "Explore our exclusive selection of sneakers.",
                searchPlaceholder: "Search by model or brand...",
                catTitle: "Explore by Brand",
                catNew: "New Arrivals",
                catNewDesc: "The latest collection",
                catSale: "Sale",
                catSaleDesc: "Limited offers",
                viewBack: "Back",
                locTitle: "Our Store",
                locAddress: "Hermanas Mirabal Ave 461, North Santo Domingo",
                footerCopy: "All rights reserved.",
                cartTitle: "ðŸ›’ Your Cart",
                cartTotal: "Total",
                cartCheckout: "Order via WhatsApp",
                cartEmpty: "Cart is empty",
                cartItemSize: "Size",
                cartItemQty: "Qty",
                toastSelectSize: "Please select a size first",
                toastAdded: "Added to cart",
                badgeNew: "NEW",
                badgeSale: "SALE",
                productSize: "Size (EU):",
                btnAdd: "Add",
                btnOrder: "Order",
                priceAsk: "Price: Contact us",
                resultsFor: "Results for",
                noResults: "No products found.",
                waOrderMsg: "Hello, I want to place an order.",
                waEstimatedTotal: "ESTIMATED TOTAL",
                formTitle: "Customer Info",
                lblName: "Full Name *",
                lblPhone: "Phone Number *",
                lblAddress: "Delivery Address *",
                lblNotes: "Notes (Optional)",
                errForm: "Please fill in Name, Phone and Address.",
                detailViewBack: "Back to Catalog",
                locBtn: "Go to Dubae Clothing"
            },
            es: {
                homeTitle: "Dubae Clothing",
                homeSubtitle: "Otro concepto de moda.",
                homeCopy: "Donde el estilo se convierte en identidad. Piezas seleccionadas que redefinen la moda moderna, la exclusividad y la actitud.",
                homeDiscover: "Descubre la ColecciÃ³n",
                collectionTitle: "ColecciÃ³n de Tenis",
                collectionSubtitle: "Explora nuestra selecciÃ³n exclusiva de calzado.",
                searchPlaceholder: "Buscar por modelo o marca...",
                catTitle: "Explorar por Marca",
                catNew: "ReciÃ©n Llegados",
                catNewDesc: "Lo mÃ¡s reciente",
                catSale: "Ofertas",
                catSaleDesc: "Promociones limitadas",
                viewBack: "Volver",
                locTitle: "Nuestra Tienda",
                locAddress: "Av. Hermanas Mirabal 461, Santo Domingo Norte",
                footerCopy: "Todos los derechos reservados.",
                cartTitle: "ðŸ›’ Tu Carrito",
                cartTotal: "Total",
                cartCheckout: "Pedir por WhatsApp",
                cartEmpty: "Carrito vacÃ­o",
                cartItemSize: "Talla",
                cartItemQty: "Cant",
                toastSelectSize: "Selecciona una talla primero",
                toastAdded: "Agregado al carrito",
                badgeNew: "NUEVO",
                badgeSale: "SALE",
                productSize: "Talla (EU):",
                btnAdd: "Agregar",
                btnOrder: "Pedir",
                priceAsk: "Precio: ContÃ¡ctanos",
                resultsFor: "Resultados para",
                noResults: "No se encontraron productos.",
                waOrderMsg: "Hola, quiero realizar un pedido.",
                waEstimatedTotal: "TOTAL ESTIMADO",
                formTitle: "Datos del Cliente",
                lblName: "Nombre Completo *",
                lblPhone: "TelÃ©fono *",
                lblAddress: "DirecciÃ³n de Entrega *",
                lblNotes: "Notas (Opcional)",
                errForm: "Por favor completa Nombre, TelÃ©fono y DirecciÃ³n.",
                detailViewBack: "Volver al CatÃ¡logo",
                locBtn: "Ir a Dubae Clothing"
            }
        };

        function formatUSD(amount) {
            if (amount === 0) return translations[currentLang].priceAsk;
            return `$${amount} USD`;
        }

        const PRODUCTS = [
            { id: 1, name: "Adidas Samba OG â€“ White/Black/Gum", brand: "Adidas", price: 135, image: "https://i.postimg.cc/KjsRSsTM/Adidas-Samba-OG-White-Black-Gum.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45] },
            { id: 2, name: "Adidas Wmns Samba OG Cracked Metallic Pack â€“ Silver", brand: "Adidas", price: 150, image: "https://i.postimg.cc/TwdVTFy8/adidas-Wmns-Samba-OG-Cracked-Metallic-Pack-Silver.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43] },
            { id: 3, name: "Adidas Wmns Samba OG Cream White Sand Strata (2024 Release)", brand: "Adidas", price: 135, image: "https://i.postimg.cc/T3rSf7QR/adidas-Wmns-Samba-OG-Cream-White-Sand-Strata-(2024-Release).jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43], isNew: true },
            { id: 4, name: "Adidas Samba OG Wonder White Shadow Red Gum (2025 Release)", brand: "Adidas", price: 165, image: "https://i.postimg.cc/yxpJJyPB/adidas-Samba-OG-Wonder-White-Shadow-Red-Gum-(2025-Release).jpg", sizes: [36, 37, 38, 39, 40], isNew: true },
            { id: 5, name: "Adidas Samba OG J White Black Gum (2023 Release)", brand: "Adidas", price: 135, image: "https://i.postimg.cc/7Yghr4Fp/adidas-Samba-OG-J-White-Black-Gum-(2023-Release).jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 6, name: "Adidas Samba OG White Red Gum", brand: "Adidas", price: 135, image: "https://i.postimg.cc/5Nrnybgf/adidas-Samba-OG-White-Red-Gum.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 7, name: "Adidas Samba OG White Green Gum", brand: "Adidas", price: 135, image: "https://i.postimg.cc/v84yDLwx/adidas-Samba-OG-White-Green-Gum.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 8, name: "New Balance 530 White/Navy", brand: "New Balance", price: 150, image: "https://i.postimg.cc/sD2T3KkH/New-Balance-530-White-Navy.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45] },
            { id: 9, name: "New Balance 530 White/Pink/Silver ABZORB", brand: "New Balance", price: 150, image: "https://i.postimg.cc/YqcyzQZV/New-Balance-530-White-Pink-Silver-ABZORB.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 10, name: "New Balance 740 Silver/Grey", brand: "New Balance", price: 150, image: "https://i.postimg.cc/W3Yc4t4r/New-Balance-740-Silver-Grey.jpg", sizes: [40, 41, 42, 43, 44, 45, 46, 47] },
            { id: 11, name: "New Balance 1906 Silver/Metallic Black", brand: "New Balance", price: 150, image: "https://i.postimg.cc/t4vcP8jf/New-Balance-1906-Silver-Metallic-Black.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 12, name: "Adidas Originals Campus 00s Core Black/Off White/Footwear White", brand: "Adidas", price: 120, image: "https://i.postimg.cc/d3SCnRVQ/adidas-Originals-Campus-00s-Core-Black-Off-White-Footwear-White.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47] },
            { id: 13, name: "New Balance 1906 Black/Silver", brand: "New Balance", price: 150, image: "https://i.postimg.cc/vZ1mWFnm/New-Balance-1906-Black-Silver.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 14, name: "New Balance 1906R Eclipse/Pink Taffy", brand: "New Balance", price: 150, image: "https://i.postimg.cc/4xR01p7z/New-Balance-1906R-Eclipse-Pink-Taffy.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 15, name: "Adidas Originals Campus 00s Black/Cream", brand: "Adidas", price: 110, image: "https://i.postimg.cc/8khXzjn7/adidas-Originals-Campus-00s-Black-Cream.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 16, name: "Adidas Originals Campus 00s Grey/White", brand: "Adidas", price: 120, image: "https://i.postimg.cc/Kj6mf4By/adidas-Originals-Campus-00s-Grey-White.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 17, name: "ASICS GEL-1130 White/Silver/Black", brand: "ASICS", price: 135, image: "https://i.postimg.cc/s2L7YdKk/ASICS-GEL-1130-White-Silver-Black.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 18, name: "Nike V5 RNR White/Reflective/Brown", brand: "Nike", price: 165, image: "https://i.postimg.cc/GtgC2KbN/Nike-V5-RNR-White-Reflective-Brown.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45], isNew: true },
            { id: 19, name: "Nike V5 RNR (Women's) Maroon/Grey/White", brand: "Nike", price: 150, image: "https://i.postimg.cc/QMYqxYPq/Nike-V5-RNR-Maroon-Grey-White.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45] },
            { id: 20, name: "Nike V5 RNR (Men's) Black/Silver/White", brand: "Nike", price: 150, image: "https://i.postimg.cc/cLwq3wZt/Nike-V5-RNR-(Men-s)-Black-Silver-White.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45] },
            { id: 21, name: "Nike V5 RNR Triple Black (Men's)", brand: "Nike", price: 150, image: "https://i.postimg.cc/SRQ4mszw/Nike-V5-RNR-Triple-Black-Mens.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45] },
            { id: 22, name: "Nike Shox R4 Midnight Navy/Gym Red/Metallic Silver", brand: "Nike", price: 150, image: "https://i.postimg.cc/dQZpTGJr/Nike-Shox-R4-Midnight-Navy-Gym-Red-Metallic-Silver.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45] },
            { id: 23, name: "Nike Shox R4 Metallic Silver/Black", brand: "Nike", price: 150, image: "https://i.postimg.cc/TwgsBX74/Nike-Shox-R4-Metallic-Silver-Black.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45] },
            { id: 24, name: "Adidas Handball Spezial Brown/White", brand: "Adidas", price: 135, image: "https://i.postimg.cc/6Q9T89R7/adidas-Handball-Spezial-Brown-White.jpg", sizes: [36, 37, 38, 39, 40] },
            { id: 25, name: "Adidas Gazelle Indoor Red/White/Gum", brand: "Adidas", price: 150, image: "https://i.postimg.cc/CLgYNwMc/new-arrival-3.jpg", sizes: [36, 37, 38, 39, 40], isNew: true },
            { id: 26, name: "Adidas Samba OG Maroon/White/Dark Brown", brand: "Adidas", price: 165, image: "https://i.postimg.cc/XYYRHJRm/Newarrival4.jpg", sizes: [36, 37, 38, 39, 40, 41], isNew: true },
            { id: 27, name: "ASICS GEL-1130 White/Silver/Brown", brand: "ASICS", price: 0, image: "https://i.postimg.cc/6QYV3b7K/ASICS-GEL-1130-White-Silver-Brown.jpg", sizes: [40, 41, 42, 43, 44, 45, 46] },
            { id: 28, name: "ASICS GEL-1130 White/Teal/Silver", brand: "ASICS", price: 0, image: "https://i.postimg.cc/v89z7zkz/ASICS-GEL-1130-White-Teal-Silver.jpg", sizes: [40, 41, 42, 43, 44, 45, 46] },
            { id: 29, name: "ASICS GT-2160 Black/Silver", brand: "ASICS", price: 0, image: "https://i.postimg.cc/mkw1XtQT/ASICS-GT-2160-Black-Silver.jpg", sizes: [40, 41, 42, 43, 44, 45, 46] },
            { id: 30, name: "Nike Running V5 RNR Light Grey/White/Silver/Black Swoosh", brand: "Nike", price: 150, image: "https://i.postimg.cc/J4SKjF4B/Nike-Running-V5-RNR-ight-Gre-White-Silver-Black-Swoosh.jpg", sizes: [36, 37, 38, 39, 40, 41, 42, 43, 44, 45], isNew: true },
            { id: 31, name: "Nike Wmns V2K Run Platinum Violet", brand: "Nike", price: 135, image: "https://i.postimg.cc/FFCwBmxD/oferta.jpg", sizes: [40, 41, 42, 43, 44, 45, 46], isSale: true },
            { id: 32, name: "Nike Blazer Mid 'White/Black' (High-Top)", brand: "Nike", price: 110, image: "https://i.postimg.cc/pV5344cG/oferta2.jpg", sizes: [36, 37, 38, 39, 40], isSale: true },
            { id: 33, name: "New Balance 710 Silver/White/Black", brand: "New Balance", price: 150, image: "https://i.postimg.cc/nL8JwZn8/Whats-App-Image-2026-01-03-at-7-42-56-PM.jpg", sizes: [40, 41, 42, 43, 44, 45, 46], isSale: true }
        ];

        let cart = [];
        let selectedSizes = {};
        let filteredProductsCache = null;

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('year').textContent = new Date().getFullYear();
            loadCart();
            applyLanguage();
            resetView();
            
            // Fix close button mobile response
            const closeBtn = document.getElementById('cart-close-btn');
            if (closeBtn) {
                // Handle touchstart specifically for fast mobile response
                // Use passive: false to allow preventDefault if needed to stop ghost clicks
                closeBtn.addEventListener('touchstart', function(e) {
                    e.preventDefault(); // Prevent ghost click logic from firing later
                    closeCart();
                }, {passive: false});
            }
        });

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('dubae_lang', lang);
            applyLanguage();
            if (!document.getElementById('product-view').classList.contains('hidden')) {
                const titleText = document.getElementById('view-title').textContent;
                if (titleText === translations.en.catNew || titleText === translations.es.catNew) setLanguageTitle(translations[lang].catNew);
                else if (titleText === translations.en.catSale || titleText === translations.es.catSale) setLanguageTitle(translations[lang].catSale);
                else if (titleText === "All" || titleText === "Todos") setLanguageTitle(lang === 'en' ? "All" : "Todos");
                renderGrid(filteredProductsCache || PRODUCTS);
            }
        }

        function applyLanguage() {
            const t = translations[currentLang];
            document.getElementById('lang-en').classList.toggle('active', currentLang === 'en');
            document.getElementById('lang-es').classList.toggle('active', currentLang === 'es');

            document.getElementById('home-title').textContent = t.homeTitle;
            document.getElementById('home-subtitle').textContent = t.homeSubtitle;
            document.getElementById('home-copy').textContent = t.homeCopy;
            document.querySelector('#home a').textContent = t.homeDiscover;

            document.getElementById('collection-title').textContent = t.collectionTitle;
            document.getElementById('collection-subtitle').textContent = t.collectionSubtitle;
            document.getElementById('search-input').placeholder = t.searchPlaceholder;
            document.getElementById('cat-title').textContent = t.catTitle;
            document.getElementById('cat-new').textContent = t.catNew;
            document.getElementById('cat-new-desc').textContent = t.catNewDesc;
            document.getElementById('cat-sale').textContent = t.catSale;
            document.getElementById('cat-sale-desc').textContent = t.catSaleDesc;
            document.getElementById('view-back').textContent = t.viewBack;
            document.getElementById('loc-title').textContent = t.locTitle;
            document.getElementById('loc-address').textContent = t.locAddress;
            document.getElementById('footer-copy').textContent = t.footerCopy;
            document.getElementById('cart-sidebar-title').textContent = t.cartTitle;
            document.getElementById('cart-total-label').textContent = t.cartTotal;
            document.getElementById('cart-checkout').textContent = t.cartCheckout;
            document.getElementById('nav-cta').childNodes[2].textContent = (currentLang === 'en' ? t.btnOrder + " Now" : "Pedir Ahora");

            // Form translations
            document.getElementById('form-title').childNodes[2].textContent = t.formTitle;
            document.getElementById('lbl-name').textContent = t.lblName;
            document.getElementById('lbl-phone').textContent = t.lblPhone;
            document.getElementById('lbl-address').textContent = t.lblAddress;
            document.getElementById('lbl-notes').textContent = t.lblNotes;

            // Location Button Translation
            document.getElementById('loc-btn-text').textContent = t.locBtn;

            updateCartUI();
        }

        function setLanguageTitle(title) {
            document.getElementById('view-title').textContent = title;
        }

        function resetView() {
            document.getElementById('category-view').classList.remove('hidden');
            document.getElementById('product-view').classList.add('hidden');
            document.getElementById('detail-view').classList.add('hidden');
            document.getElementById('search-input').value = "";
            document.getElementById('clear-search').classList.add('hidden');
        }

        function handleSearch(query) {
            const clearBtn = document.getElementById('clear-search');
            if (query.trim() === "") {
                clearBtn.classList.add('hidden');
                resetView();
                return;
            }
            clearBtn.classList.remove('hidden');
            const filtered = PRODUCTS.filter(p => 
                p.name.toLowerCase().includes(query.toLowerCase()) || 
                p.brand.toLowerCase().includes(query.toLowerCase())
            );
            filteredProductsCache = filtered;
            showProducts(filtered, `${translations[currentLang].resultsFor}: "${query}"`);
        }

        function resetSearch() {
            document.getElementById('search-input').value = "";
            resetView();
        }

        function filterByBrand(brand) {
            let filtered = [];
            let title = brand;

            if (brand === 'New Arrivals') {
                filtered = PRODUCTS.filter(p => p.isNew);
                title = translations[currentLang].catNew;
            } else if (brand === 'Sale') {
                filtered = PRODUCTS.filter(p => p.isSale);
                title = translations[currentLang].catSale;
            } else {
                filtered = PRODUCTS.filter(p => p.brand === brand);
            }

            filteredProductsCache = filtered;
            showProducts(filtered, title);
        }

        function showProducts(data, title) {
            document.getElementById('category-view').classList.add('hidden');
            document.getElementById('product-view').classList.remove('hidden');
            document.getElementById('detail-view').classList.add('hidden');
            document.getElementById('view-title').textContent = title;
            renderGrid(data);
            const catalogTop = document.getElementById('catalog').offsetTop - 100;
            window.scrollTo({ top: catalogTop, behavior: 'smooth' });
        }

        function openDetailView(productId) {
            const product = PRODUCTS.find(p => p.id === productId);
            if (!product) return;

            const t = translations[currentLang];
            const detailView = document.getElementById('detail-view');
            const priceClass = product.isSale ? 'text-red-600' : 'text-dubae-gold';

            detailView.innerHTML = `
                <div class="flex flex-col md:flex-row h-full min-h-[60vh]">
                    <!-- Image Section -->
                    <div class="w-full md:w-1/2 bg-white flex items-center justify-center p-4 md:p-8 relative">
                        <button onclick="showProducts(filteredProductsCache || PRODUCTS, document.getElementById('view-title').textContent)" 
                            class="absolute top-4 left-4 z-10 flex items-center gap-2 text-gray-500 hover:text-black font-bold bg-white/80 p-2 rounded-full backdrop-blur-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                            </svg>
                            <span class="text-sm">${t.detailViewBack}</span>
                        </button>
                        <img src="${product.image}" alt="${product.name}" class="max-h-[500px] w-full object-contain mix-blend-multiply">
                    </div>

                    <!-- Details Section -->
                    <div class="w-full md:w-1/2 p-6 md:p-12 flex flex-col justify-center bg-white">
                        <div class="mb-2">
                            ${product.isNew ? `<span class="inline-block bg-dubae-black text-white text-[10px] font-bold px-2 py-1 rounded mb-2 mr-2">${t.badgeNew}</span>` : ''}
                            ${product.isSale ? `<span class="inline-block bg-red-600 text-white text-[10px] font-bold px-2 py-1 rounded mb-2">${t.badgeSale}</span>` : ''}
                        </div>
                        <h2 class="text-2xl md:text-4xl font-serif font-bold text-gray-900 mb-2 leading-tight">${product.name}</h2>
                        <p class="text-sm text-gray-500 uppercase tracking-widest mb-6">${product.brand}</p>
                        <p class="${priceClass} text-2xl md:text-3xl font-bold mb-8">${formatUSD(product.price)}</p>

                        <div class="mb-8">
                            <span class="text-xs uppercase text-gray-400 font-bold block mb-3">${t.productSize}</span>
                            <div class="flex flex-wrap gap-2">
                                ${product.sizes.map(size => `
                                    <button onclick="selectSize(${product.id}, ${size}, this)" class="size-btn size-btn-${product.id} text-sm w-12 h-12 rounded-lg hover:border-gray-400">${size}</button>
                                `).join('')}
                            </div>
                        </div>

                        <div class="flex gap-3 md:gap-4 mt-auto">
                            <button onclick="addToCart(${product.id})" class="flex-1 bg-white border-2 border-black text-black py-4 rounded-xl font-bold text-sm uppercase hover:bg-gray-50 transition-all tracking-widest">${t.btnAdd}</button>
                            <button onclick="orderSingle(${product.id})" class="flex-1 bg-black text-white py-4 rounded-xl font-bold text-sm uppercase hover:bg-gray-800 transition-all shadow-lg tracking-widest">${t.btnOrder}</button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('category-view').classList.add('hidden');
            document.getElementById('product-view').classList.add('hidden');
            detailView.classList.remove('hidden');
            
            // Re-apply selection if exists
            if (selectedSizes[productId]) {
                // We need to wait for DOM update, but innerHTML is sync.
                // However, the buttons are recreated with new classes.
                // We don't have a direct reference to the button element here easily without querying.
                const btns = document.querySelectorAll(`.size-btn-${productId}`);
                btns.forEach(b => {
                    if (b.textContent.trim() == selectedSizes[productId]) {
                        b.classList.add('selected');
                    }
                });
            }

            window.scrollTo({ top: document.getElementById('catalog').offsetTop - 80, behavior: 'smooth' });
        }

        function renderGrid(data) {
            const grid = document.getElementById('product-grid');
            const t = translations[currentLang];
            if (data.length === 0) {
                grid.innerHTML = `<div class="col-span-full text-center py-20 text-gray-500">${t.noResults}</div>`;
                return;
            }
            grid.innerHTML = data.map(product => {
                const borderClass = product.isSale ? 'border-red-100 ring-1 ring-red-50' : 'border-gray-100';
                const priceClass = product.isSale ? 'text-red-600' : 'text-dubae-gold';
                
                return `
                <div class="bg-white rounded-xl overflow-hidden shadow-sm border ${borderClass} flex flex-col h-full group hover:shadow-xl transition-all">
                    <div class="product-img-container" onclick="openDetailView(${product.id})">
                        <img src="${product.image}" alt="${product.name}" class="product-img">
                        ${product.isNew ? `<span class="badge-label bg-dubae-black text-white">${t.badgeNew}</span>` : ''}
                        ${product.isSale ? `<span class="badge-label bg-red-600 text-white">${t.badgeSale}</span>` : ''}
                    </div>
                    <div class="p-3 md:p-4 flex-1 flex flex-col border-t border-gray-100">
                        <h3 class="text-gray-900 font-bold text-xs md:text-sm leading-tight line-clamp-2 h-8 md:h-10 mb-1 md:mb-2 cursor-pointer hover:text-dubae-gold transition-colors" onclick="openDetailView(${product.id})">${product.name}</h3>
                        <p class="${priceClass} font-bold text-sm md:text-lg mb-3 md:mb-5">${formatUSD(product.price)}</p>
                        
                        <div class="mb-4">
                            <span class="text-[9px] md:text-[10px] uppercase text-gray-400 font-bold block mb-2">${t.productSize}</span>
                            <div class="flex flex-wrap gap-1 md:gap-2">
                                ${product.sizes.slice(0, 6).map(size => `
                                    <button onclick="selectSize(${product.id}, ${size}, this)" class="size-btn size-btn-${product.id} text-[9px] md:text-xs rounded-md md:rounded-lg">${size}</button>
                                `).join('')}
                                ${product.sizes.length > 6 ? '<span class="text-[9px] flex items-center text-gray-400">...</span>' : ''}
                            </div>
                        </div>

                        <div class="mt-auto flex gap-1 md:gap-2 pt-1 md:pt-2">
                            <button onclick="addToCart(${product.id})" class="flex-1 bg-white border border-black py-2 md:py-3 rounded-lg md:rounded-xl font-bold text-[9px] md:text-xs uppercase hover:bg-gray-50 transition-all">${t.btnAdd}</button>
                            <button onclick="orderSingle(${product.id})" class="flex-1 bg-black text-white py-2 md:py-3 rounded-lg md:rounded-xl font-bold text-[9px] md:text-xs uppercase hover:bg-gray-800 transition-all shadow-md">${t.btnOrder}</button>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function selectSize(productId, size, btn) {
            selectedSizes[productId] = size;
            document.querySelectorAll(`.size-btn-${productId}`).forEach(el => el.classList.remove('selected'));
            btn.classList.add('selected');
        }

        function addToCart(productId) {
            const size = selectedSizes[productId];
            if (!size) { showToast(translations[currentLang].toastSelectSize); return; }
            const product = PRODUCTS.find(p => p.id === productId);
            const existing = cart.find(i => i.id === productId && i.size === size);
            if (existing) { existing.quantity++; } else { cart.push({ ...product, size, quantity: 1 }); }
            saveCart();
            showToast(translations[currentLang].toastAdded);
        }

        function orderSingle(productId) {
            const size = selectedSizes[productId];
            if (!size) { showToast(translations[currentLang].toastSelectSize); return; }
            const product = PRODUCTS.find(p => p.id === productId);
            const price = formatUSD(product.price);
            const t = translations[currentLang];
            
            // Sanitize product name to remove special chars that break URL encoding
            const cleanName = product.name.replace(/â€“/g, "-").replace(/â€™/g, "'").replace(/â€œ/g, '"').replace(/â€/g, '"');
            
            let msg = `${t.waOrderMsg}\n\n`;
            msg += `ðŸ‘Ÿ ${cleanName}\n`;
            msg += `ðŸ“ ${t.cartItemSize}: ${size}\n`;
            msg += `ðŸ“¦ ${t.cartItemQty}: 1\n`;
            msg += `ðŸ’° ${price}`;
            
            window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        function loadCart() {
            const saved = localStorage.getItem('dubae_cart_v3');
            if (saved) { cart = JSON.parse(saved); updateCartUI(); }
        }

        function saveCart() {
            localStorage.setItem('dubae_cart_v3', JSON.stringify(cart));
            updateCartUI();
        }

        // Refactored Cart Logic: Separate Open and Close to prevent toggling issues
        function closeCart() {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('cart-overlay');
            const body = document.body;
            
            sidebar.classList.remove('open');
            overlay.classList.remove('open');
            body.style.overflow = '';
            console.log("Cart closed");
        }

        function openCart() {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('cart-overlay');
            const body = document.body;
            
            sidebar.classList.add('open');
            overlay.classList.add('open');
            body.style.overflow = 'hidden';
        }

        // Toggle function mainly for the Nav button
        function toggleCart() {
            const sidebar = document.getElementById('cart-sidebar');
            if (sidebar.classList.contains('open')) {
                closeCart();
            } else {
                openCart();
            }
        }

        function updateCartUI() {
            const countEl = document.getElementById('cart-count');
            const totalCount = cart.reduce((acc, i) => acc + i.quantity, 0);
            const t = translations[currentLang];

            if (totalCount > 0) { countEl.textContent = totalCount; countEl.classList.remove('hidden'); } else { countEl.classList.add('hidden'); }

            const itemsContainer = document.getElementById('cart-items');
            const formContainer = document.getElementById('cart-customer-form');
            
            if (cart.length === 0) {
                itemsContainer.innerHTML = `<div class="text-center py-20 text-gray-400">${t.cartEmpty}</div>`;
                formContainer.classList.add('hidden');
                document.getElementById('cart-total').textContent = "$0 USD";
                return;
            }

            formContainer.classList.remove('hidden');

            let total = 0;
            itemsContainer.innerHTML = cart.map((item, idx) => {
                const itemUSD = item.price || 0;
                total += itemUSD * item.quantity;
                return `
                <div class="flex gap-4 bg-gray-50 p-3 rounded-xl border border-gray-100 relative">
                    <img src="${item.image}" class="w-16 h-16 object-contain mix-blend-multiply bg-white rounded-lg p-1">
                    <div class="flex-1">
                        <h4 class="font-bold text-sm line-clamp-1">${item.name}</h4>
                        <p class="text-xs text-gray-500">${t.cartItemSize}: ${item.size} | ${t.cartItemQty}: ${item.quantity}</p>
                        <p class="text-dubae-gold font-bold text-sm mt-1">${formatUSD(item.price)}</p>
                    </div>
                    <button onclick="removeFromCart(${idx})" class="absolute top-2 right-2 text-gray-300 hover:text-red-500">âœ•</button>
                </div>
                `;
            }).join('');
            document.getElementById('cart-total').textContent = `$${total} USD`;
        }

        function removeFromCart(idx) {
            cart.splice(idx, 1);
            saveCart();
        }

        function checkoutCart() {
            if (cart.length === 0) return;
            const t = translations[currentLang];
            
            // Form Validation
            const name = document.getElementById('cust-name').value.trim();
            const phone = document.getElementById('cust-phone').value.trim();
            const address = document.getElementById('cust-address').value.trim();
            const notes = document.getElementById('cust-notes').value.trim();

            if (!name || !phone || !address) {
                showToast(t.errForm);
                // Highlight fields
                if (!name) document.getElementById('cust-name').classList.add('border-red-500');
                if (!phone) document.getElementById('cust-phone').classList.add('border-red-500');
                if (!address) document.getElementById('cust-address').classList.add('border-red-500');
                return;
            } else {
                document.getElementById('cust-name').classList.remove('border-red-500');
                document.getElementById('cust-phone').classList.remove('border-red-500');
                document.getElementById('cust-address').classList.remove('border-red-500');
            }
            
            let msg = `${t.waOrderMsg}\n\n`;

            msg += `Customer Information:\n`;
            msg += `Name: ${name}\n`;
            msg += `Phone: ${phone}\n`;
            msg += `Address: ${address}\n`;
            if (notes) msg += `Notes: ${notes}\n`;
            
            msg += `\nOrder Details:\n`;

            let total = 0;
            
            cart.forEach((item, index) => {
                const usd = item.price || 0;
                total += usd * item.quantity;
                const cleanName = item.name.replace(/â€“/g, "-").replace(/â€™/g, "'").replace(/â€œ/g, '"').replace(/â€/g, '"');

                msg += `ðŸ‘Ÿ ${cleanName}\n`;
                msg += `ðŸ“ ${t.cartItemSize}: ${item.size}\n`;
                msg += `ðŸ“¦ ${t.cartItemQty}: ${item.quantity}\n`;
                msg += `ðŸ’° ${formatUSD(item.price)}\n`;
                
                if (index < cart.length - 1) {
                    msg += `\n`;
                }
            });
            
            msg += `\n${t.waEstimatedTotal}: $${total} USD`;
            
            window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').textContent = msg;
            toast.classList.remove('translate-y-[-150%]', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');
            setTimeout(() => {
                toast.classList.remove('translate-y-0', 'opacity-100');
                toast.classList.add('translate-y-[-150%]', 'opacity-0');
            }, 3000);
        }
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
